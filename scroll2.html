<!doctype html>
<html lang="en">
	<head>
		<title>scroll</title>
		<meta charset="utf-8" />
		<!--script type="application/javascript" src="http://steenk.github.io/tripledollar.js"></script-->
		<script>
		(function () {
  var VERSION = '0.6.3';
/*
 * The triple dollar function creates a DOM object.
 */
  var $$$ = function () {
    var args = Array.prototype.slice.call(arguments);
    if (typeof args[0] !== 'string') {
      if (Array.isArray(args[0])) {
        return $$$.apply(this, args[0]);
      } else {
        //throw new Error("The input to tripledollar is not valid.");
      }
    }

    /*
     * Splitting up the ident parameter into element type, id, and class names. 
     */
    var ident = args.shift()
     ,  n = ident.split(/[\.#]/)
     ,  t = ident.split(/[^\.#]+/)
     ,  e;
    if (t[0] !== '' || n[0] === '') {
      //throw new Error("The identity paramameter didn't start with a tag name.");
    }
    n.forEach(function (v, i) {
      if (i === 0) {
        e = document.createElement(v);
      } else {
        if (t[i] === '.') {
          e.classList.add(v);
        } else if (t[i] === '#') {
          e.setAttribute('id', v);
        }
      }
    });

    function allArgs (args) {
      for (var i=0; i<args.length; i++) {
        var param = args[i];
        if (param && param.nodeType) {
          e.appendChild(param);
        } else if (typeof param === 'object') {
          if (Array.isArray(param)) {
            e.appendChild($$$.apply(this, param));
          } else {
            for (var a in param) {
              if (a.match(/^data./)) {
                var atr = a.substr(4).toLowerCase();
                e.setAttribute('data-' + atr, param[a]);
              } else {
                e.setAttribute(a, param[a]);
              }
            }
          }
        } else {
          e.appendChild(document.createTextNode(String(param)));
        }
      }
    };
    allArgs(args);
    /*
     * Add CSS to the element.
     */
    e.css = function (obj) {
      for (var k in obj) {
        this.style[k] = obj[k];
      };
      return this;
    };
    /*
     * Set a property.
     */
    e.set = function (key, val) {
      this[key] = val;
      return this;
    };
    /*
     * Run a function.
     */
    e.fun = function (func) {
      var args = Array.prototype.slice.call(arguments, 1);
      this[func].apply(this, args);
      return this;
    };
    /*
     * Add event listener
     */
    e.evt = function (ev, func) {
      if (arguments.length > 2) {
        var args = Array.prototype.slice.call(arguments, 2);
        this.addEventListener(ev, function (e) {var a = [e].concat(args); func.apply(this, a)});
      } else {
        this.addEventListener(ev, func);
      }
      return this;
    };
    /*
     * Insert more things to this element
     */
    e.ins = function () {
      var args = Array.prototype.slice.call(arguments);
      allArgs(args);
    };
    /*
     * Add an alias for a CSS selector
     */
    e.$ = e.querySelectorAll;
    e.prototype = e;
    return e;
  };

  $$$.version = VERSION;

  /*
   * Structify an element node
   */
  $$$.structify = function (elem) {
    if (elem.nodeType === 1) {
      function dig (c) {
        var l = []
         ,  name = c.localName
         ,  cname = c.className.replace(' ', '.');
        if (cname) {
          name += '.'+cname;
        };
        if (c.id) {
          name += '#'+c.id;
        };
        l.push(name);
        if (c.hasAttributes()) {
          var attrs = c.attributes
           ,  attr = {};
          for (var i=0; i<attrs.length; i++) {
            if (!attrs[i].name.match(/id|class|contenteditable/)) {
              attr[attrs[i].name] = attrs[i].value;              
            }
          }
          if (Object.keys(attr).length > 0) {
            l.push(attr);
          }
        }
        c.normalize();
        var ch = c.childNodes;
        for (var i=0; i<ch.length; i++) {
          if(ch[i].nodeType === 3) {
            var s = ch[i].data.replace(/\s\s*/,' ');
            if (s.length > 0) {
              l.push(s);
            }
          } else if (ch[i].nodeType === 1) {
            l.push(dig(ch[i]));
          }
        }
        return l;
      }
    }
    var td = dig(elem);
    return td;
  }

  /* 
   * A shortcut for placing the content on the web page.
   */
  $$$.appendToDoc = function () {
    var args = Array.prototype.slice.call(arguments);
    for (var i=0; i<args.length; i++) {
      if (Array.isArray(args[i])) {
        document.body.appendChild($$$(args[i]));
      } else if (args[i] instanceof HTMLElement) {
        document.body.appendChild(args[i]);
      } else {
        //throw Error("Undefined input to tripledollar.");
      }
    }
  }

  /*
   * Use AMD if a module loader is in place.
   */
  if (typeof define === 'function') {
    define(function (require) {
      return $$$;
    }) 
  } else {
    window.$$$ = $$$;
    window.tripledollar = $$$.appendToDoc;
  }

  /*
   * In case a $ function is not initialized.
   */
  if (! window.$ && document.querySelectorAll) {window.$ = function (sel) { return document.querySelectorAll(sel);}};

})();
</script>
		<style>
		body {
			padding: 0;
			margin: 0;
		}
		div {
			width: 900px;
			height: 900px;
			margin-left: auto;
			margin-right: auto;
			border-bottom: solid gray 1px;
		}
		</style>
	</head>
	<body>
		<script>
		var ipsum = 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus nunc sapien, porta id pellentesque at, elementum et felis. Curabitur condimentum ante in metus iaculis quis congue diam commodo. Donec eleifend ante sed nulla dapibus convallis. Ut cursus aliquam neque, vel porttitor tellus interdum ut. Sed pharetra lacinia adipiscing. In tristique tristique felis non tincidunt. Nulla auctor mauris a velit cursus ultricies. In at libero quis justo consectetur laoreet. Nullam id ultrices nunc. Donec non turpis nulla, eu lacinia ante. Nunc eu orci et turpis pretium venenatis. Nam molestie, lacus at dignissim elementum, ante libero consectetur libero, ut lacinia lacus urna et purus. Nullam lorem ipsum, dapibus vel ullamcorper a, malesuada a metus. Sed porta adipiscing magna, quis pulvinar purus mattis fringilla. Integer pellentesque sapien in neque tristique ac iaculis libero ultricies. Ut eget pharetra purus.' +

'Nulla in convallis tellus. Proin tincidunt suscipit vulputate. Suspendisse potenti. Nullam tristique justo mi, a tristique ligula. Duis convallis aliquam iaculis. Nulla dictum fringilla congue. Suspendisse ac leo lectus, ac aliquam justo. Ut porttitor commodo mi sed luctus. Nulla at enim lorem. Nunc eu justo sapien, a blandit odio. Curabitur faucibus sollicitudin dolor, id lacinia sem auctor in. Donec varius nunc at lectus sagittis nec luctus arcu pharetra. Nunc sed metus justo. Cras vel mauris diam. Ut feugiat felis eget neque pharetra vestibulum consectetur massa facilisis. Quisque consectetur luctus nisi quis tincidunt. Vivamus cursus cursus quam non blandit. Pellentesque et velit lacus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.' +

'In et dolor vitae orci adipiscing congue. Aliquam gravida nibh at nisl gravida molestie. Curabitur a bibendum sapien. Aliquam tincidunt, nulla nec pretium lobortis, odio augue tincidunt arcu, a lobortis odio sem ut purus. Donec accumsan mattis nunc vitae lacinia. Suspendisse potenti. Integer commodo nisl quis nibh interdum non fringilla dui sodales. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. In hac habitasse platea dictumst. Etiam ullamcorper, mi id feugiat bibendum, purus neque cursus mauris, id sodales quam nisi id velit. Sed lectus leo, tincidunt vel rhoncus imperdiet, blandit in leo. Integer quis magna nulla. Donec vel nisl magna, ut rhoncus dui. Aliquam gravida, nulla nec eleifend luctus, neque nibh pharetra ante, quis egestas elit metus a mi. Nunc nec augue quam. Morbi tincidunt tristique varius. Suspendisse iaculis elit feugiat magna pellentesque ultricies. Vestibulum aliquam tortor non ante ullamcorper fringilla. Donec iaculis mi quis mauris ornare vestibulum.' +

'In a magna nisi, a ultricies massa. Donec elit neque, viverra non tempor quis, fringilla in metus. Integer odio odio, euismod vitae mollis sed, sodales eget libero. Donec nec massa in felis ornare pharetra at nec tellus. Nunc lorem dolor, pretium vel auctor in, volutpat vitae felis. Maecenas rhoncus, orci vel blandit euismod, turpis erat tincidunt ante, elementum adipiscing nisl urna in nisi. Phasellus sagittis, enim sed accumsan consequat, urna augue lobortis erat, non malesuada quam metus sollicitudin ante. In leo purus, dignissim quis varius vel, pellentesque et nibh. In sed tortor iaculis libero mollis pellentesque id vitae lectus. In hac habitasse platea dictumst. Phasellus mauris enim, posuere eget luctus ac, iaculis et quam. Vivamus et nibh diam, elementum egestas tellus. Aenean vulputate malesuada est. Sed posuere porta diam a sodales. Proin eu sem non velit facilisis venenatis sed a turpis.';

		function smoothScroll(x, y) {
			var d, e;
			if ((e = Math.abs(d = y - window.scrollY)) > 1) {
				console.log(e);
				window.scrollBy(0, (d < 0 ? -1 : 1) * (e > 5 ? Math.round(e/10) : 1));
				setTimeout(function () {smoothScroll(x, y)}, 10);
			}
		}

		$$$.appendToDoc (
			['div#top', 'top', {style:'background-color: yellow'},
				$$$('button', 'to middle').evt('click', function () {
					var p = $('#middle')[0].offsetTop;
					smoothScroll(0, p);
				}),
				$$$('button', 'to bottom').evt('click', function () {
					var p = $('#bottom')[0].offsetTop;
					smoothScroll(0, p);
				}), ['p', ipsum]
			],
			['div#middle', 'middle', {style:'background-color: green'},
				$$$('button', 'to bottom').evt('click', function () {
					var p = $('#bottom')[0].offsetTop;
					smoothScroll(0, p);
				}), ['p', ipsum]
			],
			['div#bottom', 'bottom', {style:'background-color: red'},
				$$$('button', 'to top').evt('click', function () {
					smoothScroll(0, 0);
				}), ['p', ipsum]
			]
		)
</script>
	</body>
</html>
